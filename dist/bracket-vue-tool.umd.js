(function(O,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(O=typeof globalThis<"u"?globalThis:O||self,e(O.BracketVueTool={},O.Vue))})(this,function(O,e){"use strict";const x={SINGLE_ELIMINATION:"single_elimination",DOUBLE_ELIMINATION:"double_elimination"},y="TBD",r={ONE:"teamOne",TWO:"teamTwo"},p={CAN_SELECT_TEAM:"can_select_team",CAN_EDIT_DATE:"can_edit_date",CAN_EDIT_SCOPE:"can_edit_scope",CAN_EDIT_ROUND_NAME:"can_edit_round_name",CAN_EDIT_BEST_OF:"can_edit_best_of"},U={key:0,class:"flex items-center gap-2"},V=["src","alt"],q=["value","disabled"],v={key:1,class:"flex items-center gap-2"},W=["src","alt"],F={class:"text-gray-900 dark:text-white"},P={__name:"TeamSelect",props:{team:{type:Object,required:!0},teamPosition:{type:String,required:!0},availableTeams:{type:Array,required:!0},selectedTeams:{type:Array,required:!0},canEdit:{type:Boolean,required:!0},highlightedTeam:{type:Number,default:null},permissions:{type:Object,required:!0,default:()=>({[p.CAN_SELECT_TEAM]:!0})},isWinner:{type:Boolean,default:!1},isLoser:{type:Boolean,default:!1},shouldHighlight:{type:Boolean,default:!1}},emits:["update:team","highlight-team","unhighlight-team"],setup(t,{emit:T}){const a=t,o=T,n=e.ref(a.team.name),i=e.computed(()=>{var c;return n.value===y?null:((c=a.availableTeams.find(f=>f.name===n.value))==null?void 0:c.logo)||null});e.watch(()=>a.team,c=>{n.value=c.name},{immediate:!0}),e.onMounted(()=>{console.log("TeamSelect mounted:",{team:a.team,availableTeams:a.availableTeams})});const h=c=>c===y?!1:a.selectedTeams.includes(c)&&c!==a.team.name||c===a.team.name&&a.team.name!==y,E=e.computed(()=>a.availableTeams?a.availableTeams.filter(c=>c.name===y||c.name===a.team.name?!0:!h(c.name)):[]),m=()=>{a.team.name!==y&&o("highlight-team",a.team.name)},g=()=>{o("unhighlight-team")},b=()=>{const c=a.availableTeams.find(f=>f.name===n.value);console.log("Updating team:",{selectedTeam:n.value,selectedTeamData:c}),o("update:team",{position:a.teamPosition,team:{id:(c==null?void 0:c.id)||null,name:n.value,logo:(c==null?void 0:c.logo)||null,score:0}})};return(c,f)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["flex-grow p-2.5 hover:bg-gray-200/30 dark:hover:bg-gray-950/20",{"hover:bg-green-500/20 dark:hover:bg-green-500/20":t.isWinner,"hover:bg-red-500/20 dark:hover:bg-red-500/20":t.isLoser,"bg-green-500/20 dark:bg-green-500/20":t.shouldHighlight&&t.isWinner,"bg-red-500/20 dark:bg-red-500/20":t.shouldHighlight&&t.isLoser}]),onMouseenter:m,onMouseleave:g},[t.canEdit&&t.permissions[e.unref(p).CAN_SELECT_TEAM]?(e.openBlock(),e.createElementBlock("div",U,[i.value?(e.openBlock(),e.createElementBlock("img",{key:0,src:i.value,alt:n.value,class:"w-6 h-6 rounded-full"},null,8,V)):e.createCommentVNode("",!0),e.withDirectives(e.createElementVNode("select",{"onUpdate:modelValue":f[0]||(f[0]=u=>n.value=u),class:"fi-select-input p-0 w-full border-none bg-transparent text-base text-gray-900 transition duration-75 focus:ring-0 disabled:text-gray-500 disabled:[-webkit-text-fill-color:theme(colors.gray.500)] dark:text-white dark:disabled:text-gray-400 dark:disabled:[-webkit-text-fill-color:theme(colors.gray.400)] sm:text-sm sm:leading-6 [&_optgroup]:bg-white [&_optgroup]:dark:bg-gray-900 [&_option]:bg-white [&_option]:dark:bg-gray-900 hover:cursor-pointer",onChange:b},[f[1]||(f[1]=e.createElementVNode("option",{value:"TBD"},"TBD",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(E.value,u=>(e.openBlock(),e.createElementBlock("option",{key:u.id,value:u.name,disabled:h(u.name)},e.toDisplayString(u.name),9,q))),128))],544),[[e.vModelSelect,n.value]])])):(e.openBlock(),e.createElementBlock("div",v,[t.team.logo?(e.openBlock(),e.createElementBlock("img",{key:0,src:t.team.logo,alt:t.team.name,class:"w-6 h-6 rounded-full"},null,8,W)):e.createCommentVNode("",!0),e.createElementVNode("span",F,e.toDisplayString(t.team.name),1)]))],34))}},j={key:1,class:"text-white"},R={__name:"TeamScoreInput",props:{team:{type:Object,required:!0},teamPosition:{type:String,required:!0},canEditScore:{type:Boolean,required:!0},isFirstTeam:{type:Boolean,default:!1}},emits:["update:score"],setup(t,{emit:T}){const a=t,o=T,n=e.ref(!1),i=e.ref(a.team.score??0),h=()=>{a.canEditScore&&(n.value=!0)},E=()=>{const m=parseInt(i.value)||0;o("update:score",{position:a.teamPosition,score:m})};return e.watch(()=>a.team,m=>{i.value=m.score??0},{deep:!0}),(m,g)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["p-2.5 bg-orange-500 dark:bg-orange-600 cursor-pointer min-w-10 text-center",{"border-b border-orange-600 dark:border-orange-700":t.isFirstTeam}]),onClick:h},[n.value?e.withDirectives((e.openBlock(),e.createElementBlock("input",{key:0,type:"number","onUpdate:modelValue":g[0]||(g[0]=b=>i.value=b),class:"w-12 border-none bg-orange-500 dark:bg-orange-600 text-center text-white text-base transition duration-75 focus:ring-0 disabled:text-gray-500 disabled:[-webkit-text-fill-color:theme(colors.gray.500)] dark:text-white dark:disabled:text-gray-400 dark:disabled:[-webkit-text-fill-color:theme(colors.gray.400)] sm:text-sm sm:leading-6 [&_optgroup]:bg-white [&_optgroup]:dark:bg-gray-900 [&_option]:bg-white [&_option]:dark:bg-gray-900",min:"0",onChange:E,onBlur:g[1]||(g[1]=b=>n.value=!1)},null,544)),[[e.vModelText,i.value]]):(e.openBlock(),e.createElementBlock("span",j,e.toDisplayString(t.team.score),1))],2))}},H={class:"flex"},I={__name:"TeamRow",props:{team:{type:Object,required:!0},teamPosition:{type:String,required:!0},availableTeams:{type:Array,required:!0},selectedTeams:{type:Array,required:!0},canEdit:{type:Boolean,required:!0},canEditScore:{type:Boolean,required:!0},isWinner:{type:Boolean,default:!1},isLoser:{type:Boolean,default:!1},shouldHighlight:{type:Boolean,default:!1},isFirstTeam:{type:Boolean,default:!1},highlightedTeam:{type:Number,default:null},permissions:{type:Object,required:!0,default:()=>({[p.CAN_SELECT_TEAM]:!0,[p.CAN_EDIT_SCOPE]:!0})}},emits:["update:team","update:score","highlight-team","unhighlight-team"],setup(t){return(T,a)=>(e.openBlock(),e.createElementBlock("div",H,[e.createVNode(P,{team:t.team,"team-position":t.teamPosition,"available-teams":t.availableTeams,"selected-teams":t.selectedTeams,"highlighted-team":t.highlightedTeam,permissions:t.permissions,"can-edit":t.canEdit,"is-winner":t.isWinner,"is-loser":t.isLoser,"should-highlight":t.shouldHighlight,"is-first-team":t.isFirstTeam,"onUpdate:team":a[0]||(a[0]=o=>T.$emit("update:team",o)),onHighlightTeam:a[1]||(a[1]=o=>T.$emit("highlight-team",o)),onUnhighlightTeam:a[2]||(a[2]=o=>T.$emit("unhighlight-team"))},null,8,["team","team-position","available-teams","selected-teams","highlighted-team","permissions","can-edit","is-winner","is-loser","should-highlight","is-first-team"]),e.createVNode(R,{team:t.team,"team-position":t.teamPosition,"can-edit-score":t.canEditScore,"is-first-team":t.isFirstTeam,"onUpdate:score":a[3]||(a[3]=o=>T.$emit("update:score",o))},null,8,["team","team-position","can-edit-score","is-first-team"])]))}},z={class:"flex flex-col w-full"},J={class:"px-3 py-1 text-xs text-gray-500 dark:text-gray-400 flex items-center justify-center"},G=["value","disabled"],K={class:"my-1.5 ml-2.5 bg-white dark:bg-gray-900 rounded overflow-hidden w-full min-w-[200px] shadow-sm ring-1 ring-gray-950/5 dark:bg-gray-900 dark:ring-white/10"},Q={key:0,class:"absolute top-1/2 left-full w-2.5 h-[calc(100%+2px)] border-2 border-gray-300 dark:border-gray-600 border-l-0 rounded-r flex items-center z-10 -mt-[-10px] ml-[15px] mx-2 transition-colors duration-200"},X={__name:"BracketMatch",props:{match:{type:Object,required:!0,default:()=>({teamOne:{name:y,score:0},teamTwo:{name:y,score:0},winner:null,date:new Date().toISOString().split("T")[0]})},index:{type:Number,required:!0},totalMatches:{type:Number,required:!0},availableTeams:{type:Array,required:!0},selectedTeams:{type:Array,required:!0},roundIndex:{type:Number,required:!0},highlightedTeam:{type:String,default:null},permissions:{type:Object,required:!0,default:()=>({[p.CAN_SELECT_TEAM]:!0,[p.CAN_EDIT_DATE]:!0,[p.CAN_EDIT_SCOPE]:!0})}},emits:["update:match","highlight-team","unhighlight-team"],setup(t,{emit:T}){const a=t,o=T,n=e.computed(()=>a.roundIndex===0&&a.permissions[p.CAN_SELECT_TEAM]),i=e.computed(()=>a.match[r.ONE].name!==y&&a.match[r.TWO].name!==y&&a.permissions[p.CAN_EDIT_SCOPE]),h=l=>a.match.winner===l,E=l=>a.match.winner&&a.match.winner!==l,m=l=>{const d=a.match[l].name;return a.highlightedTeam===d},g=l=>{o("highlight-team",l)},b=()=>{o("unhighlight-team")},c=({position:l,team:d})=>{const s={...a.match,[l]:d};o("update:match",s)},f=({position:l,score:d})=>{const s={...a.match,[l]:{...a.match[l],score:d}};s[r.ONE].score>s[r.TWO].score?s.winner=r.ONE:s[r.TWO].score>s[r.ONE].score?s.winner=r.TWO:s.winner=null,o("update:match",s)},u=l=>l?new Date(l).toISOString().slice(0,16):"",N=l=>{const d={...a.match,date:l.target.value};o("update:match",d)};return(l,d)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["relative text-[0.8em] flex items-center",{group:t.index%2==0&&t.totalMatches>1}])},[e.createElementVNode("div",z,[e.createElementVNode("div",J,[e.createElementVNode("input",{type:"datetime-local",value:u(t.match.date),onInput:N,class:"bg-transparent border-none focus:ring-0 p-0 text-xs",disabled:!t.permissions[e.unref(p).CAN_EDIT_DATE]},null,40,G)]),e.createElementVNode("div",K,[e.createVNode(I,{team:t.match.teamOne,"team-position":e.unref(r).ONE,"available-teams":t.availableTeams,"selected-teams":t.selectedTeams,"can-edit":n.value,"can-edit-score":i.value,"is-winner":h(e.unref(r).ONE),"is-loser":E(e.unref(r).ONE),"should-highlight":m(e.unref(r).ONE),"is-first-team":!0,"can-select-team":l.canSelectTeam,"highlighted-team":t.highlightedTeam,permissions:t.permissions,"onUpdate:team":c,"onUpdate:score":f,onHighlightTeam:g,onUnhighlightTeam:b},null,8,["team","team-position","available-teams","selected-teams","can-edit","can-edit-score","is-winner","is-loser","should-highlight","can-select-team","highlighted-team","permissions"]),e.createVNode(I,{team:t.match.teamTwo,"team-position":e.unref(r).TWO,"available-teams":t.availableTeams,"selected-teams":t.selectedTeams,"can-edit":n.value,"can-edit-score":i.value,"is-winner":h(e.unref(r).TWO),"is-loser":E(e.unref(r).TWO),"should-highlight":m(e.unref(r).TWO),"can-select-team":l.canSelectTeam,"highlighted-team":t.highlightedTeam,permissions:t.permissions,"onUpdate:team":c,"onUpdate:score":f,onHighlightTeam:g,onUnhighlightTeam:b},null,8,["team","team-position","available-teams","selected-teams","can-edit","can-edit-score","is-winner","is-loser","should-highlight","can-select-team","highlighted-team","permissions"])])]),t.index%2==0&&t.totalMatches>1?(e.openBlock(),e.createElementBlock("div",Q,d[0]||(d[0]=[e.createElementVNode("span",{class:"w-2.5 h-0.5 bg-gray-300 dark:bg-gray-600 translate-x-full block"},null,-1)]))):e.createCommentVNode("",!0)],2))}},Y={class:"flex-1 px-5 pb-2.5 grid grid-cols-[min-content_auto]"},Z={class:"text-[0.7em] text-gray-900 dark:text-white flex justify-end items-center opacity-50 mt-[23px]"},M={__name:"BracketColumn",props:{column:{type:Object,required:!0},columnIndex:{type:Number,required:!0},availableTeams:{type:Array,required:!0},selectedTeams:{type:Array,required:!0},highlightedTeam:{type:String,default:null},permissions:{type:Object,required:!0,default:()=>({[p.CAN_SELECT_TEAM]:!0})}},emits:["update:match","highlight-team","unhighlight-team"],setup(t,{emit:T}){const a=t,o=T,n=(i,h)=>{o("update:match",a.columnIndex,i,h)};return(i,h)=>(e.openBlock(),e.createElementBlock("div",Y,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.column.matches,(E,m)=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:E.id},[e.createElementVNode("div",Z,e.toDisplayString(E.number),1),e.createVNode(X,{match:E,index:m,"total-matches":t.column.matches.length,"round-index":t.columnIndex,"available-teams":t.availableTeams,"selected-teams":t.selectedTeams,"highlighted-team":t.highlightedTeam,permissions:t.permissions,"onUpdate:match":g=>n(m,g),onHighlightTeam:h[0]||(h[0]=g=>i.$emit("highlight-team",g)),onUnhighlightTeam:h[1]||(h[1]=g=>i.$emit("unhighlight-team"))},null,8,["match","index","total-matches","round-index","available-teams","selected-teams","highlighted-team","permissions","onUpdate:match"])],64))),128))]))}},ee={class:"flex justify-between px-5"},te={class:"flex flex-col items-center gap-2"},ae={class:"mt-2"},ne={class:"flex items-center rounded-md bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-600"},le=["onUpdate:modelValue","onBlur","disabled"],ie={class:"grid shrink-0 grid-cols-1 focus-within:relative"},oe=["value","onChange","disabled"],re=["value"],D={__name:"BracketRoundHeaders",props:{columns:{type:Array,required:!0},permissions:{type:Object,required:!0}},emits:["update:columns"],setup(t,{emit:T}){const a=t,o=T,n=[1,3,5,7,9],i=e.ref(a.columns.map(m=>m.name));e.watch(()=>a.columns,m=>{i.value=m.map(g=>g.name)},{deep:!0});const h=(m,g)=>{i.value[m]=g;const b=[...a.columns];b[m]={...b[m],name:g},o("update:columns",b)},E=(m,g)=>{const b=[...a.columns];b[m]={...b[m],bestOf:Number(g)},o("update:columns",b)};return(m,g)=>(e.openBlock(),e.createElementBlock("div",ee,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.columns,(b,c)=>(e.openBlock(),e.createElementBlock("div",{key:b.name,class:"flex-1 text-center text-sm text-gray-400 py-2 rounded overflow-hidden"},[e.createElementVNode("div",te,[e.createElementVNode("div",ae,[e.createElementVNode("div",ne,[e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":f=>i.value[c]=f,onBlur:f=>h(c,f.target.value),disabled:!t.permissions[e.unref(p).CAN_EDIT_ROUND_NAME],class:"block min-w-0 grow py-1.5 pr-3 text-gray-800 dark:text-white border-none pl-1 text-base text-gray-900 bg-white dark:bg-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm/6"},null,40,le),[[e.vModelText,i.value[c]]]),e.createElementVNode("div",ie,[e.createElementVNode("select",{value:b.bestOf,onChange:f=>E(c,f.target.value),disabled:!t.permissions[e.unref(p).CAN_EDIT_BEST_OF],class:"col-start-1 row-start-1 w-full text-gray-800 dark:text-white border-none appearance-none py-1.5 bg-white dark:bg-gray-900 pr-7 pl-3 text-base text-gray-500 placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6"},[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(n,f=>e.createElementVNode("option",{key:f,value:f}," Best of "+e.toDisplayString(f),9,re)),64))],40,oe)])])])])]))),128))]))}},se={class:"flex flex-col mt-8 border-t-2 border-gray-300 dark:border-gray-600 pt-8"},ce={class:"flex flex-col"},me={class:"overflow-x-auto"},de={class:"min-w-max"},ue={class:"flex flex-1 p-5"},he={__name:"BracketLower",props:{initialState:{type:Array,required:!0},availableTeams:{type:Array,required:!0},defaultBestOf:{type:Number,default:3,validator:t=>[1,3,5,7,9].includes(t)},permissions:{type:Object,required:!0,default:()=>({[p.CAN_SELECT_TEAM]:!0,[p.CAN_EDIT_DATE]:!0,[p.CAN_EDIT_SCOPE]:!0,[p.CAN_EDIT_ROUND_NAME]:!0,[p.CAN_EDIT_BEST_OF]:!0})}},emits:["update:state"],setup(t,{emit:T}){const a=T,o=t,n=e.ref([]),i=e.ref(null),h=e.computed(()=>{const u=new Set;return n.value.forEach(N=>{N.matches.forEach(l=>{l[r.ONE].name!==y&&u.add(l[r.ONE].name),l[r.TWO].name!==y&&u.add(l[r.TWO].name)})}),Array.from(u)}),E=u=>{i.value=u},m=()=>{i.value=null},g=(u,N,l)=>{if(console.log("Updating lower match:",{roundIndex:u,matchIndex:N,updatedMatch:l}),n.value[u]&&n.value[u].matches){if(n.value[u].matches[N]=l,l.winner&&u<n.value.length-1){const d=u+1,s=Math.floor(N/2);if(n.value[d]&&n.value[d].matches[s]){const k=n.value[d].matches[s],w=N%2===0?r.ONE:r.TWO,B=l[l.winner];n.value[d].matches[s]={...k,[w]:{id:B.id,name:B.name,logo:B.logo,score:0}}}}c()}},b=u=>{console.log("Updating lower columns:",u),n.value=u,c()},c=()=>{console.log("Emitting lower tournament state:",n.value),a("update:state",n.value)},f=()=>{console.log("Initializing lower tournament with state:",o.initialState),o.initialState&&o.initialState.length>0&&(n.value=JSON.parse(JSON.stringify(o.initialState)))};return e.watch(()=>o.initialState,()=>{f()},{deep:!0}),e.onMounted(()=>{f()}),(u,N)=>(e.openBlock(),e.createElementBlock("div",se,[N[0]||(N[0]=e.createElementVNode("div",{class:"text-xl font-bold text-gray-800 dark:text-white mb-4"},"Lower Bracket",-1)),e.createElementVNode("div",ce,[e.createElementVNode("div",me,[e.createElementVNode("div",de,[e.createVNode(D,{columns:n.value,"onUpdate:columns":b,permissions:t.permissions},null,8,["columns","permissions"]),e.createElementVNode("div",ue,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.value,(l,d)=>(e.openBlock(),e.createBlock(M,{key:l.id,column:l,"column-index":d,"available-teams":t.availableTeams,"selected-teams":h.value,"highlighted-team":i.value,permissions:t.permissions,"onUpdate:match":g,onHighlightTeam:E,onUnhighlightTeam:m},null,8,["column","column-index","available-teams","selected-teams","highlighted-team","permissions"]))),128))])])])])]))}},L=()=>({id:null,name:y,logo:null,score:0}),_=t=>({id:`match-${t}`,number:t,[r.ONE]:L(),[r.TWO]:L(),winner:null,date:null}),ge=(t,T=3)=>{const a=[],o=Math.log2(t);let n=1;for(let i=0;i<o;i++){const h=Math.pow(2,o-i-1),E=[];for(let m=0;m<h;m++)E.push(_(n++));a.push({id:`upper-round-${i+1}`,name:`Round ${i+1}`,matches:E,bestOf:T})}return a},A=(t,T)=>{const a=[];let o=1;const n=t-1;for(let i=0;i<n;i++){const h=Math.pow(2,t-i-2),E=[];for(let m=0;m<h;m++)E.push(_(o++));a.push({id:`lower-round-${i+1}`,name:`Lower Round ${i+1}`,matches:E,bestOf:T})}return a},fe={class:"flex flex-col"},pe={class:"flex flex-col"},Te={class:"overflow-x-auto"},Ee={class:"min-w-max"},be={class:"flex flex-1 p-5"},$={__name:"TournamentBracket",props:{initialState:{type:Object,required:!0},availableTeams:{type:Array,required:!0},defaultBestOf:{type:Number,required:!0},format:{type:String,required:!0},permissions:{type:Object,required:!0,default:()=>({[p.CAN_SELECT_TEAM]:!0,[p.CAN_EDIT_ROUND_NAME]:!0,[p.CAN_EDIT_BEST_OF]:!0})}},emits:["update:state"],setup(t,{emit:T}){const a=T,o=t,n=e.ref([]),i=e.ref([]),h=e.ref(null),E=e.computed(()=>{const l=new Set;return n.value.forEach(d=>{d.matches.forEach(s=>{s[r.ONE].name!==y&&l.add(s[r.ONE].name),s[r.TWO].name!==y&&l.add(s[r.TWO].name)})}),o.format===x.DOUBLE_ELIMINATION&&i.value.forEach(d=>{d.matches.forEach(s=>{s[r.ONE].name!==y&&l.add(s[r.ONE].name),s[r.TWO].name!==y&&l.add(s[r.TWO].name)})}),Array.from(l)}),m=l=>{h.value=l},g=()=>{h.value=null},b=(l,d,s)=>{if(console.log("Updating upper match:",{roundIndex:l,matchIndex:d,updatedMatch:s}),n.value[l]&&n.value[l].matches){if(n.value[l].matches[d]=s,s.winner&&l<n.value.length-1){const k=l+1,w=Math.floor(d/2);if(n.value[k]&&n.value[k].matches[w]){const B=n.value[k].matches[w],C=d%2===0?r.ONE:r.TWO,S=s[s.winner];n.value[k].matches[w]={...B,[C]:{id:S.id,name:S.name,logo:S.logo,score:0}}}}if(o.format===x.DOUBLE_ELIMINATION&&s.winner){const k=s[s.winner===r.ONE?r.TWO:r.ONE];if(k.name!==y){const w=Math.floor(l/2),B=Math.floor(d/2);if(i.value[w]&&i.value[w].matches[B]){const C=i.value[w].matches[B],S=d%2===0?r.ONE:r.TWO;i.value[w].matches[B]={...C,[S]:{id:k.id,name:k.name,logo:k.logo,score:0}}}}}u()}},c=l=>{console.log("Updating upper columns:",l),n.value=l,u()},f=l=>{console.log("Updating lower state:",l),i.value=l,u()},u=()=>{console.log("Emitting tournament state:",{upper:n.value,lower:o.format===x.DOUBLE_ELIMINATION?i.value:null}),a("update:state",{upper:n.value,lower:o.format===x.DOUBLE_ELIMINATION?i.value:null})},N=()=>{console.log("Initializing tournament with state:",o.initialState),o.initialState&&(Array.isArray(o.initialState)?(n.value=JSON.parse(JSON.stringify(o.initialState)),o.format===x.DOUBLE_ELIMINATION&&(i.value=A(n.value.length,o.defaultBestOf))):(n.value=JSON.parse(JSON.stringify(o.initialState.upper||[])),i.value=JSON.parse(JSON.stringify(o.initialState.lower||[]))))};return e.watch(()=>o.initialState,()=>{N()},{deep:!0}),e.watch(()=>o.format,l=>{l===x.DOUBLE_ELIMINATION&&(!i.value||i.value.length===0)&&(i.value=A(n.value.length,o.defaultBestOf),u())}),e.onMounted(()=>{N()}),(l,d)=>(e.openBlock(),e.createElementBlock("div",fe,[d[0]||(d[0]=e.createElementVNode("div",{class:"text-xl font-bold text-gray-800 dark:text-white mb-4"},"Upper Bracket",-1)),e.createElementVNode("div",pe,[e.createElementVNode("div",Te,[e.createElementVNode("div",Ee,[e.createVNode(D,{columns:n.value,"onUpdate:columns":c,permissions:t.permissions},null,8,["columns","permissions"]),e.createElementVNode("div",be,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.value,(s,k)=>(e.openBlock(),e.createBlock(M,{key:s.id,column:s,"column-index":k,"available-teams":t.availableTeams,"selected-teams":E.value,"highlighted-team":h.value,permissions:t.permissions,"onUpdate:match":b,onHighlightTeam:m,onUnhighlightTeam:g},null,8,["column","column-index","available-teams","selected-teams","highlighted-team","permissions"]))),128))])])])]),t.format===e.unref(x).DOUBLE_ELIMINATION?(e.openBlock(),e.createBlock(he,{key:0,"initial-state":i.value,"available-teams":t.availableTeams,"default-best-of":t.defaultBestOf,permissions:t.permissions,"onUpdate:state":f},null,8,["initial-state","available-teams","default-best-of","permissions"])):e.createCommentVNode("",!0)]))}},ye=t=>{t.component("TournamentBracket",$)};O.PERMISSIONS=p,O.TournamentBracket=$,O.createLowerBracketStructure=A,O.createTournamentState=ge,O.install=ye,Object.defineProperty(O,Symbol.toStringTag,{value:"Module"})});
